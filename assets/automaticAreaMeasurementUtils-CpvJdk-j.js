import{cy as Q,hU as X,oY as W,ad as tt,oZ as et,eo as at,a8 as E,o_ as C,o$ as H,p0 as nt,cw as I,p1 as z,aA as it,jz as A,p2 as ot,p3 as st,hH as lt,d6 as P,aY as rt,p4 as V,p5 as v,e as s,y as l,k as x,S as ut,cd as ct,gp as Z,p6 as G,dQ as $,p7 as j,p8 as L,p9 as Y,pa as g,pb as pt,j4 as ft,pc as ht,pd as dt}from"./index-r0Ml_rWi.js";import{G as mt,M as gt,_ as vt,w as B,B as h,H as yt,L as kt,J as bt,A as xt,K as T}from"./Tooltip-DRVBThmE.js";import{N as $t}from"./MeshTransform-DryXxlwG.js";import{U as It}from"./quantityFormatUtils-DO2xTIHV.js";import{U as N,o as At,j as wt}from"./euclideanAreaMeasurementUtils-Bjutw6Gc.js";function Et(e,a){const t=X(a.vertexSpace),{scale:n,orientation:i}=e,{transform:u}=a,r=Lt(u);t&&r!=null?(i.actual=V(r,"degrees","arithmetic"),i.visible=!0):(i.actual=null,i.visible=!1),t?(n.actual=v(J(u)),n.visible=!0):(n.actual=null,n.visible=!1)}function Ht(e,a,t){var _,U,F,R,S,D,O;if(!a||!X(a.vertexSpace))return;const n=a.transform??(a.transform=new $t),{rotationAngle:i,rotationAxis:u}=n,r=W(e.orientation.actual),c=q(u);if(r!=null&&c!=null&&r!==i){(_=t==null?void 0:t.onRotateStart)==null||_.call(t,i);const f=r*c;n.rotationAngle=f,(U=t==null?void 0:t.onRotate)==null||U.call(t,f),(F=t==null?void 0:t.onRotateStop)==null||F.call(t,f)}const d=(R=e.scale.actual)==null?void 0:R.value,m=J(n);if(d!=null&&d!==m){const{scale:f}=n;let p;if((S=t==null?void 0:t.onScaleStart)==null||S.call(t,f[0],f[1],f[2]),m===0)p=tt(et);else{const K=d/m;p=at(E(),f,K)}n.scale=p,(D=t==null?void 0:t.onScale)==null||D.call(t,p[0],p[1],p[2]),(O=t==null?void 0:t.onScaleStop)==null||O.call(t,p[0],p[1],p[2])}}function Zt(e,a){const{x:t,y:n,z:i}=a,{x:u,y:r,z:c}=Vt(e,a.spatialReference);return{dx:u==null||I(u,t)?0:u-t,dy:r==null||I(r,n)?0:r-n,dz:c==null||i==null||I(c,i)?0:c-i}}function Vt(e,a){var u,r,c;let t,n,i;if(e.geographic){t=z(e.longitude.actual),n=z(e.latitude.actual),it(a)&&(t!=null&&n!=null?[t,n]=A(t,n,w):t!=null?t=A(t,0,w)[0]:n!=null&&(n=A(0,n,w)[1]));const d=e.elevation.actual,m=ot(a);i=m!=null&&d!=null?st(d,m):void 0}else t=(u=e.x.actual)==null?void 0:u.value,n=(r=e.y.actual)==null?void 0:r.value,i=(c=e.elevation.actual)==null?void 0:c.value;return{x:t,y:n,z:i}}const w=[0,0];function Lt(e){if(!e)return 0;const a=q(e.rotationAxis);return a!=null?a*e.rotationAngle:null}function q(e){return C(e,H)?1:C(e,Mt)?-1:null}const Mt=Q(E(),H);function J(e){return e?Math.max(...e.scale):1}function Gt(e,a){return!(e.type!=="key-down"||e.key!==nt.enterInputMode||!a||!_t(a.info))&&(a.enterInputMode(),e.stopPropagation(),!0)}function _t(e){const a=e==null?void 0:e.sketchOptions;if(!a)return!1;const{inputEnabled:t,visibleElements:n}=a.tooltips;return t&&e.editableFields.some(({name:i})=>i==="x"||i==="y"?n.coordinates:n[i])===!0}function Nt(e){let a=null;return lt([e.on("paste",async t=>{a==null||a.abort(),a=P(async()=>{vt()||await B(),Ut(t,e.info)})}),P(()=>B()),rt(()=>a==null?void 0:a.abort())])}function Ut(e,a){var n;if(!a||!("geographic"in a))return;const t=(n=e.clipboardData)==null?void 0:n.getData("text");if(t)if(a.geographic){const i=mt(t);i&&(a.longitude.applyValue(i.longitude),a.latitude.applyValue(i.latitude),e.stopPropagation(),e.preventDefault())}else{const i=gt(t);i&&(a.x.applyValue(i.x),a.y.applyValue(i.y),e.stopPropagation(),e.preventDefault())}}let o=class extends ut{constructor(e){super(e),this.actual=null,this.lockable=!0,this.id=ct(),this.inputValue=null,this.readOnly=!1,this.suffix=null,this.visible=!0,this.invalid=!1,this.unlockOnVertexPlacement=!0}get committed(){return this.lockable?this._get("committed"):null}set committed(e){this.lockable&&this._set("committed",e)}get dirty(){return this.inputValue!=null}get locked(){return this.lockable&&this.committed!=null}onInput(e){this.inputValue=e}onCommit(e,a,t){this.lockable?this._onCommitLockable(e,t):this._onCommitNonLockable(t),this.invalid&&e==="commit-and-exit"||t.onCommit(a,e)}_onCommitLockable(e,a){const{inputValue:t,locked:n}=this;n&&y(t)?this.unlock():(e==="commit-and-exit"&&!n||t!=null)&&this._parseInputAndLock(a)}_onCommitNonLockable(e){const{inputValue:a}=this;y(a)?this.setActual(null):a!=null&&this._parseInputAndSetActual(e)}applyValue(e){this.lockable?this.lock(e):this.setActual(e)}clearInputValue(){this.inputValue=null,this.invalid=!1}setActual(e){this.actual=e,this.clearInputValue()}lock(e){this.lockable&&(this.committed=e??this.actual,this.clearInputValue())}unlock(){this.lockable&&(this.committed=null,this.clearInputValue())}toggleLock(e){this.lockable&&(this.locked?this.unlock():this._parseInputAndLock(e))}getSuffix(e){const{suffix:a}=this;return typeof a=="function"?a(e):a}getFormattedValue(e){const{actual:a,committed:t,format:n}=this;return t!=null?n(t,e):a!=null?n(a,e):null}getRawDisplayValue(e){const{actual:a,committed:t,inputValue:n}=this;return n??(this.lockable&&t!=null?this.formatForInputMode(t,e):a!=null?this.formatForInputMode(a,e):null)}_parseInputAndSetActual(e){const{inputValue:a}=this;if(a==null||y(a))return this.setActual(null);const t=this.parse(a,e);t!=null?this.setActual(t):this.invalid=!0}_parseInputAndLock(e){const{inputValue:a,actual:t}=this;if(y(a))return this.unlock();if(a==null)return this.lock(t);const n=this.parse(a,e);n!=null?this.lock(n):this.invalid=!0}};function y(e){return e!=null&&e.trim()===""}s([l()],o.prototype,"actual",void 0),s([l()],o.prototype,"committed",null),s([l()],o.prototype,"dirty",null),s([l()],o.prototype,"format",void 0),s([l()],o.prototype,"formatForInputMode",void 0),s([l()],o.prototype,"lockable",void 0),s([l()],o.prototype,"locked",null),s([l()],o.prototype,"id",void 0),s([l()],o.prototype,"inputValue",void 0),s([l()],o.prototype,"name",void 0),s([l()],o.prototype,"parse",void 0),s([l()],o.prototype,"readOnly",void 0),s([l()],o.prototype,"suffix",void 0),s([l()],o.prototype,"title",void 0),s([l()],o.prototype,"visible",void 0),s([l()],o.prototype,"invalid",void 0),s([l()],o.prototype,"unlockOnVertexPlacement",void 0),o=s([x("esri.views.interactive.tooltip.fields.TooltipField")],o);let k=class extends o{constructor(e){super(e),this.showAsZ=!1}normalizeCtorArgs(e){const a=t=>t.inputUnitInfos.verticalLength.unit;return{name:"elevation",actual:Z,parse:h((t,n)=>G(t,a(n))),format:(t,n)=>n.formatters.verticalLength(t),formatForInputMode:(t,n)=>n.formatters.scalar($(t,a(n))),suffix:t=>t.inputUnitInfos.verticalLength.abbreviation,title:t=>t.messages.sketch[this.showAsZ?"z":"elevation"],unlockOnVertexPlacement:!1,...e}}};s([l()],k.prototype,"showAsZ",void 0),k=s([x("esri.views.interactive.tooltip.fields.TooltipFieldElevation")],k);let b=class extends o{constructor(e){super(e),this.precision=1}normalizeCtorArgs(e){const a=t=>t.inputUnitInfos.orientation.unit;return{name:"orientation",actual:null,parse:h((t,n)=>V(t,a(n),"geographic")),format:t=>{const n=j(t);return It(n,"geographic",this.precision)},formatForInputMode:(t,n)=>{const i=j(t);return n.formatters.scalar(i)},suffix:t=>t.inputUnitInfos.orientation.abbreviation,title:t=>t.messages.sketch.orientation,...e}}};s([l()],b.prototype,"precision",void 0),b=s([x("esri.views.interactive.tooltip.fields.TooltipFieldOrientation")],b);function qt(e){const a=n=>n.inputUnitInfos.direction.unit,t=n=>n.sketchOptions.values.effectiveDirectionMode;return new o({name:"direction",actual:L,parse:h((n,i)=>V(n,a(i),"geographic")),format:(n,i)=>{const u=t(i),r=Y(n,u);switch(u){case g.Absolute:return i.formatters.direction(r);case g.Relative:return i.formatters.directionRelative(r);case g.RelativeBilateral:return i.formatters.directionRelativeBilateral(r)}},formatForInputMode:(n,i)=>{const u=Y(n,t(i));return i.formatters.scalar($(u,a(i)))},suffix:n=>n.inputUnitInfos.direction.abbreviation,title:n=>{const i=t(n),{absolute:u,relative:r}=n.messages.sketch.direction;switch(i){case g.Absolute:return u;case g.Relative:case g.RelativeBilateral:return r}},...e})}function Ft(e){const a=t=>t.inputUnitInfos.length.unit;return new o({name:"distance",actual:Z,parse:h((t,n)=>G(Math.max(t,0),a(n))),format:(t,n)=>n.formatters.length(t),formatForInputMode:(t,n)=>n.formatters.scalar($(t,a(n))),suffix:t=>t.inputUnitInfos.length.abbreviation,title:t=>t.messages.sketch.distance,...e})}function Jt(){return Ft({format:(e,a)=>a.formatters.totalLength(e),title:e=>e.messages.sketch.totalLength,readOnly:!0})}function Rt(e){return new k(e)}function Kt(e){return new b(e)}function Qt(e){return M("scale",{name:"scale",actual:null,parse:h(a=>v(Math.abs(a))),...e})}function Wt(e){const a=t=>t.inputUnitInfos.area.unit;return new o({name:"area",actual:pt,parse:h((t,n)=>ft(t,a(n))),format:(t,n)=>n.formatters.area(t),formatForInputMode:(t,n)=>n.formatters.scalar($(t,a(n))),suffix:t=>t.inputUnitInfos.area.abbreviation,title:t=>t.messages.sketch.area,readOnly:!0,...e})}function St(e){return new o({name:"x",actual:L,parse:yt,format:(a,t)=>t.formatters.longitudeDecimalDegrees(a),formatForInputMode:a=>kt(a),suffix:a=>a.inputUnitInfos.longitudeLatitude.abbreviation,title:a=>a.messages.sketch.longitude,...e})}function Dt(e){return new o({name:"y",actual:L,parse:bt,format:(a,t)=>t.formatters.latitudeDecimalDegrees(a),formatForInputMode:a=>xt(a),suffix:a=>a.inputUnitInfos.longitudeLatitude.abbreviation,title:a=>a.messages.sketch.latitude,...e})}function Ot(e){return M("x",{name:"x",...e})}function Ct(e){return M("y",{name:"y",...e})}function M(e,a){return new o({actual:v(0),parse:h(t=>v(t)),format:(t,n)=>n.formatters.scalar(t),formatForInputMode:(t,n)=>n.formatters.scalar(t),title:t=>t.messages.sketch[e],...a})}const te=e=>{let a=class extends e{constructor(){super(...arguments),this.longitude=St(),this.latitude=Dt(),this.x=Ot(),this.y=Ct(),this.elevation=Rt(),this.geographic=!1}get effectiveX(){return this.geographic?this.longitude:this.x}get effectiveY(){return this.geographic?this.latitude:this.y}get key(){return{longitude:this.longitude.actual,latitude:this.latitude.actual,x:this.x.actual,y:this.y.actual,elevation:this.elevation.actual,geographic:this.geographic}}setLocationFromPoint(t,n=t==null?void 0:t.spatialReference){if(this.geographic=!!n&&ht(n),t==null)return this._setActualLonLat(null,null),void this._setActualXY(null,null);if(this.geographic){const i=dt(t,zt);this._setActualLonLat(T(i==null?void 0:i[0]),T(i==null?void 0:i[1]))}else this._setActualXY(v(t.x),v(t.y))}_setActualLonLat(t,n){this.longitude.actual=t,this.latitude.actual=n}_setActualXY(t,n){this.x.actual=t,this.y.actual=n}};return s([l()],a.prototype,"geographic",void 0),s([l()],a.prototype,"effectiveX",null),s([l()],a.prototype,"effectiveY",null),s([l()],a.prototype,"key",null),a=s([x("esri.views.interactive.tooltip.infos.TooltipInfoWithCoordinates")],a),a},zt=[0,0];function Pt(e,a,t=N()){{const n=At(e);return n??wt(e,t)}}function ee(e,a=N()){return Pt(e,"on-the-ground",a)}export{Ut as B,Qt as F,Gt as G,Ft as I,Wt as M,Et as R,Nt as T,Jt as U,Zt as V,qt as b,te as h,Ht as k,ee as u,Kt as x};
